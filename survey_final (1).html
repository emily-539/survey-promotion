<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¹ì§„ ì˜ì‚¬ê²°ì • ì„¤ë¬¸ì¡°ì‚¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667788 0%, #556677 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 20px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #556677;
            padding-bottom: 15px;
        }

        h2 {
            color: #6c757d;
            font-size: 22px;
            margin: 30px 0 20px 0;
        }

        .intro-text {
            background: #f8f9fa;
            padding: 15px 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #556677;
            font-size: 16px;
            line-height: 1.8;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
            font-size: 15px;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #6c757d;
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-group input {
            flex: 1;
        }

        .input-group span {
            font-weight: bold;
            color: #666;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            background: #f8f9fa;
            border-color: #6c757d;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-option.selected {
            background: #e9ecef;
            border-color: #6c757d;
        }

        .question {
            background: #f8f9fa;
            padding: 10px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #556677;
        }

        .question-text {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
            color: #333;
        }

        .likert-scale {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            flex-wrap: wrap;
        }

        .likert-option {
            flex: 1;
            min-width: 120px;
            padding: 12px 8px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .likert-option:hover {
            background: #f0f0f0;
            border-color: #6c757d;
        }

        .likert-option input[type="radio"] {
            display: none;
        }

        .likert-option.selected {
            background: #6c757d;
            color: white;
            border-color: #6c757d;
        }

        .scenario-box {
            background: #fff3e0;
            padding: 25px 10px 25px 25px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #ff9800;
        }

        .scenario-title {
            font-size: 18px;
            font-weight: bold;
            color: #555555;
            margin-bottom: 15px;
        }

        .scenario-condition {
            margin: 12px 0;
            padding: 10px;
            background: white;
            border-radius: 6px;
            font-size: 15px;
        }

        .scenario-condition strong {
            color: #6c757d;
            color: #6c757d;
        }

        .slider-container {
            margin: 25px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
            color: #666;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #6c757d;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #6c757d;
            cursor: pointer;
            border: none;
        }

        .slider-value {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #6c757d;
            margin-top: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6c757d 0%, #556677 100%);
            transition: width 0.3s;
        }

        .progress-text {
            text-align: center;
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }

        .btn {
            padding: 14px 32px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6c757d 0%, #556677 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
            margin-right: 10px;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 10px;
        }

        .btn-group-center {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 15px;
        }

        .error-message {
            color: #f44336;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .completion-icon {
            text-align: center;
            font-size: 80px;
            color: #4caf50;
            margin: 30px 0;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .alert-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #1565c0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .likert-scale {
                flex-direction: column;
            }

            .likert-option {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í˜ì´ì§€ 1: ì•ˆë‚´ -->
        <div class="page active" id="page-intro">
            <h1>ë³´ìˆ˜ì œë„ ë³€ê²½ ì‹œ ìŠ¹ì§„ ì˜ì‚¬ê²°ì • ì„¤ë¬¸ì¡°ì‚¬</h1>
            <div class="intro-text">
                <p><strong>ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ.</strong></p>
                <p style="margin-top: 15px;">
                    ë³¸ ì¡°ì‚¬ëŠ” <strong>ë³´ìˆ˜ ë° ì¸ì‚¬ì œë„ ë³€ê²½ ì‹œ ê·¼ë¡œìì˜ ìŠ¹ì§„ ì˜ì‚¬ê²°ì • ë³€í™”ë¥¼ íƒìƒ‰í•˜ê¸° ìœ„í•œ ì„¤ë¬¸</strong>ì…ë‹ˆë‹¤.
                </p>
                <p style="margin-top: 15px;">
                    ë³¸ ì„¤ë¬¸ì€ ê³µê³µê¸°ê´€ 4ì§ê¸‰ ì§ì›ì´ 3ì§ê¸‰(ì´ˆê¸‰ê°„ë¶€)ë¡œ ìŠ¹ì§„í•  ë•Œ ë‹¤ì–‘í•œ ì œë„ì  ì¡°ê±´ë“¤ì´ 
                    ìŠ¹ì§„ ì˜í–¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì•Œì•„ë³´ê¸° ìœ„í•´ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
                </p>
                <p style="margin-top: 15px;">
                    ì„¤ë¬¸ì€ ì•½ 15-20ë¶„ ì •ë„ ì†Œìš”ë˜ë©°, ì—¬ëŸ¬ë¶„ì˜ ì†”ì§í•œ ì‘ë‹µì´ ì—°êµ¬ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.
                </p>
            </div>
            <div class="btn-group-center">
                <button class="btn btn-primary" onclick="nextPage()">ì‹œì‘í•˜ê¸°</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 2: ë™ì˜ -->
        <div class="page" id="page-consent">
            <h1>ì—°êµ¬ ì°¸ì—¬ ë™ì˜</h1>
            <div class="intro-text">
                <p><strong>ê°œì¸ì •ë³´ ë³´í˜¸ ë° ì—°êµ¬ ìœ¤ë¦¬</strong></p>
                <p style="margin-top: 15px;">
                    â€¢ ì‘ë‹µì€ <strong>ì™„ì „íˆ ìµëª…</strong>ìœ¼ë¡œ ìˆ˜ì§‘ë˜ë©°, ê°œì¸ì„ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì •ë³´ëŠ” ìˆ˜ì§‘ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </p>
                <p style="margin-top: 10px;">
                    â€¢ ìˆ˜ì§‘ëœ ìë£ŒëŠ” <strong>ì—°êµ¬ ëª©ì ìœ¼ë¡œë§Œ</strong> í™œìš©ë˜ë©°, í†µê³„ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ë°œí‘œë©ë‹ˆë‹¤.
                </p>
                <p style="margin-top: 10px;">
                    â€¢ ë³¸ ì„¤ë¬¸ ì°¸ì—¬ëŠ” ìë°œì ì´ë©°, ì–¸ì œë“ ì§€ ì°¸ì—¬ë¥¼ ì¤‘ë‹¨í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                <p style="margin-top: 10px;">
                    â€¢ ì—°êµ¬ ê²°ê³¼ëŠ” í•™ìˆ ì  ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
                </p>
            </div>
            <div class="form-group">
                <div class="radio-group">
                    <label class="radio-option" onclick="selectConsent(true)">
                        <input type="radio" name="consent" value="agree">
                        <span>ìœ„ ë‚´ìš©ì„ ì´í•´í•˜ì˜€ìœ¼ë©°, ì„¤ë¬¸ì— ì°¸ì—¬í•˜ëŠ” ê²ƒì— ë™ì˜í•©ë‹ˆë‹¤.</span>
                    </label>
                    <label class="radio-option" onclick="selectConsent(false)">
                        <input type="radio" name="consent" value="disagree">
                        <span>ë™ì˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</span>
                    </label>
                </div>
                <p class="error-message" id="consent-error">ì°¸ì—¬ ë™ì˜ ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            </div>
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="checkConsent()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 3: ê¸°ë³¸ì •ë³´ -->
        <div class="page" id="page-demographics">
            <h1>ê¸°ë³¸ ì •ë³´</h1>
            <p style="color: #666; margin-bottom: 20px;">ê·€í•˜ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>

            <div class="form-group">
                <label>1. ì†Œì† ê¸°ê´€</label>
                <select id="organization" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="í•œêµ­ë‚¨ë¶€ë°œì „">í•œêµ­ë‚¨ë¶€ë°œì „</option>
                    <option value="í•œêµ­ìˆ˜ë ¥ì›ìë ¥">í•œêµ­ìˆ˜ë ¥ì›ìë ¥</option>
                    <option value="í•œêµ­ì „ë ¥ê³µì‚¬">í•œêµ­ì „ë ¥ê³µì‚¬</option>
                </select>
            </div>

            <div class="form-group">
                <label>2. í˜„ì¬ ì§ê¸‰</label>
                <select id="grade" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="4ê¸‰">4ê¸‰</option>
                </select>
            </div>

            <div class="form-group">
                <label>3. ì§ì¢…</label>
                <select id="job-type" onchange="toggleJobTypeOther()" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ì‚¬ë¬´ì§">ì‚¬ë¬´ì§</option>
                    <option value="ìƒì‚°ì§">ìƒì‚°ì§</option>
                    <option value="ê¸°ìˆ ì§">ê¸°ìˆ ì§</option>
                    <option value="ì—°êµ¬ì§">ì—°êµ¬ì§</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
                <input type="text" id="job-type-other" placeholder="ì§ì¢…ì„ ì…ë ¥í•˜ì„¸ìš”" style="margin-top: 10px; display: none;">
            </div>

            <div class="form-group">
                <label>4. ì¬ì§ ê¸°ê°„</label>
                <div class="input-group">
                    <input type="number" id="years" placeholder="ì—°ìˆ˜" min="0" max="50" required>
                    <span>ë…„</span>
                    <input type="number" id="months" placeholder="ê°œì›”" min="0" max="11" required>
                    <span>ê°œì›”</span>
                </div>
            </div>

            <div class="form-group">
                <label>5. ì¶œìƒì—°ë„ (ì˜ˆ: 1985)</label>
                <input type="number" id="birth-year" placeholder="YYYY" min="1940" max="2010" required>
            </div>

            <div class="form-group">
                <label>6. ì„±ë³„</label>
                <select id="gender" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ë‚¨">ë‚¨</option>
                    <option value="ì—¬">ì—¬</option>
                </select>
            </div>

            <div class="form-group">
                <label>7. ìµœì¢… ì •ê·œ êµìœ¡</label>
                <select id="education" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ê³ ë“±í•™êµ ì¡¸ì—…">ê³ ë“±í•™êµ ì¡¸ì—…</option>
                    <option value="ëŒ€í•™êµ ì¡¸ì—…">ëŒ€í•™êµ ì¡¸ì—…</option>
                    <option value="ì„ì‚¬ ì¡¸ì—…">ì„ì‚¬ ì¡¸ì—…</option>
                    <option value="ë°•ì‚¬ ì¡¸ì—…">ë°•ì‚¬ ì¡¸ì—…</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
            </div>

            <div class="form-group">
                <label>8. í˜¼ì¸ ì—¬ë¶€</label>
                <select id="marital-status" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ë¯¸í˜¼">ë¯¸í˜¼</option>
                    <option value="ê¸°í˜¼">ê¸°í˜¼</option>
                </select>
            </div>

            <div class="form-group">
                <label>9. ìë…€ ìˆ˜</label>
                <select id="children" required>
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ì—†ìŒ">ì—†ìŒ</option>
                    <option value="1ëª…">1ëª…</option>
                    <option value="2ëª…">2ëª…</option>
                    <option value="3ëª… ì´ìƒ">3ëª… ì´ìƒ</option>
                </select>
            </div>

            <p class="error-message" id="demographics-error">ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="validateDemographics()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 4: ì„¤ë¬¸ A -->
        <div class="page" id="page-survey-a">
            <h1>ì¼ë°˜ ì„¤ë¬¸ (1/4)</h1>
            <div class="progress-text">ì „ì²´ ì§„í–‰ë¥ : 10%</div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 10%"></div>
            </div>
            <p style="color: #666; margin-bottom: 20px; font-weight: bold;">
                â… . ë‹¤ìŒì€ ê·€í•˜ì˜ <strong>ì§ë¬´ ë™ê¸°</strong>ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•œ ë¬¸í•­ì…ë‹ˆë‹¤. ê·€í•˜ì˜ ìƒê°ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì— í‘œì‹œí•´ì£¼ì‹­ì‹œì˜¤.
            </p>

            <div class="question" data-question="A1">
                <div class="question-text">A1. [ì—…ë¬´ ì„±ì·¨ê°] ë‚˜ëŠ” ë‚´ê°€ í•˜ëŠ” ì§ë¬´ë¥¼ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰í•˜ì˜€ì„ ë•Œ ë³´ëŒì„ ëŠë‚€ë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'A1', 1)">
                        <input type="radio" name="A1" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A1', 2)">
                        <input type="radio" name="A1" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A1', 3)">
                        <input type="radio" name="A1" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A1', 4)">
                        <input type="radio" name="A1" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A1', 5)">
                        <input type="radio" name="A1" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="A2">
                <div class="question-text">A2. [ë´‰ê¸‰] ë‚˜ëŠ” ì§ì¥ìƒí™œì—ì„œ ë³´ìˆ˜ê°€ ë§¤ìš° ì¤‘ìš”í•œ ìš”ì¸ ì¤‘ í•˜ë‚˜ë¼ê³  ìƒê°í•œë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'A2', 1)">
                        <input type="radio" name="A2" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A2', 2)">
                        <input type="radio" name="A2" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A2', 3)">
                        <input type="radio" name="A2" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A2', 4)">
                        <input type="radio" name="A2" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A2', 5)">
                        <input type="radio" name="A2" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="A3">
                <div class="question-text">A3. [ìŠ¹ì§„] ìŠ¹ì§„ ê°€ëŠ¥ì„±ì€ ë‚´ê°€ ì—…ë¬´ë¥¼ ëª°ì…í•˜ëŠ”ë° ì¤‘ìš”í•œ ìš”ì¸ì´ë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'A3', 1)">
                        <input type="radio" name="A3" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A3', 2)">
                        <input type="radio" name="A3" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A3', 3)">
                        <input type="radio" name="A3" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A3', 4)">
                        <input type="radio" name="A3" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A3', 5)">
                        <input type="radio" name="A3" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="A4">
                <div class="question-text">A4. [ì‚¬íšŒì  ì¸ì •] ë‚˜ëŠ” ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë‚˜ë¥¼ ì¸ì •í•´ì£¼ëŠ” ê²ƒì— ê°•í•œ ì˜ìš•ì„ ëŠë‚€ë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'A4', 1)">
                        <input type="radio" name="A4" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A4', 2)">
                        <input type="radio" name="A4" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A4', 3)">
                        <input type="radio" name="A4" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A4', 4)">
                        <input type="radio" name="A4" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'A4', 5)">
                        <input type="radio" name="A4" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <p class="error-message" id="survey-a-error">ëª¨ë“  ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</p>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="validateSurveyA()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 5: ì„¤ë¬¸ B -->
        <div class="page" id="page-survey-b">
            <h1>ì¼ë°˜ ì„¤ë¬¸ (2/4)</h1>
            <div class="progress-text">ì „ì²´ ì§„í–‰ë¥ : 20%</div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 20%"></div>
            </div>
            <p style="color: #666; margin-bottom: 20px; font-weight: bold;">
                â…¡. ë‹¤ìŒì€ ê·€í•˜ì˜ <strong>ë¦¬ë”ì‹­ íŠ¹ì„±</strong>ì„ ì•Œì•„ë³´ê¸° ìœ„í•œ ë¬¸í•­ì…ë‹ˆë‹¤. ë³¸ì¸ì˜ ìƒê°ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì— í‘œì‹œí•´ì£¼ì‹­ì‹œì˜¤.
            </p>

            <div class="question" data-question="B1">
                <div class="question-text">B1. ë‚˜ëŠ” ì¡°ì§ì—ì„œ ë¦¬ë” ì—­í• ì„ ë§¡ëŠ” ê²ƒì— ë¶€ë‹´ì„ ëŠë¼ê±°ë‚˜ í”¼í•˜ê³  ì‹¶ë‹¤ê³  ìƒê°í•  ë•Œê°€ ìì£¼ ìˆë‹¤. <span style="color: #f44336;">[ì—­ë¬¸í•­]</span></div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'B1', 1)">
                        <input type="radio" name="B1" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B1', 2)">
                        <input type="radio" name="B1" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B1', 3)">
                        <input type="radio" name="B1" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B1', 4)">
                        <input type="radio" name="B1" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B1', 5)">
                        <input type="radio" name="B1" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="B2">
                <div class="question-text">B2. ë‚˜ëŠ” ë™ë£Œë“¤ì„ ì´ëŒê³  ì¡°ì§ì˜ ëª©í‘œ ë‹¬ì„±ì— ì ê·¹ì ìœ¼ë¡œ ê¸°ì—¬í•˜ê³  ì‹¶ë‹¤ëŠ” ì—´ë§ì´ ê°•í•˜ë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'B2', 1)">
                        <input type="radio" name="B2" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B2', 2)">
                        <input type="radio" name="B2" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B2', 3)">
                        <input type="radio" name="B2" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B2', 4)">
                        <input type="radio" name="B2" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B2', 5)">
                        <input type="radio" name="B2" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="B3">
                <div class="question-text">B3. ë‚˜ëŠ” ì–´ë ¤ìš´ ìƒí™©ì—ì„œë„ íŒ€ì„ ì´ëŒê³  í•´ê²°ì±…ì„ ì°¾ëŠ” ë° ì£¼ë„ì ìœ¼ë¡œ ì°¸ì—¬í•˜ê³  ì‹¶ë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'B3', 1)">
                        <input type="radio" name="B3" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B3', 2)">
                        <input type="radio" name="B3" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B3', 3)">
                        <input type="radio" name="B3" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B3', 4)">
                        <input type="radio" name="B3" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'B3', 5)">
                        <input type="radio" name="B3" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <p class="error-message" id="survey-b-error">ëª¨ë“  ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</p>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="validateSurveyB()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 6: ì„¤ë¬¸ C -->
        <div class="page" id="page-survey-c">
            <h1>ì¼ë°˜ ì„¤ë¬¸ (3/4)</h1>
            <div class="progress-text">ì „ì²´ ì§„í–‰ë¥ : 30%</div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 30%"></div>
            </div>
            <p style="color: #666; margin-bottom: 20px; font-weight: bold;">
                â…¢. ë‹¤ìŒì€ í˜„ì¬ ê·¼ë¬´í•˜ëŠ” ê¸°ê´€ì˜ <strong>ë³´ìˆ˜ì œë„</strong>ì— ê´€í•œ ê·€í•˜ì˜ ì˜ê²¬ì„ íŒŒì•…í•˜ê¸° ìœ„í•œ ë¬¸í•­ì…ë‹ˆë‹¤. ë³¸ì¸ì˜ ìƒê°ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì— í‘œì‹œí•´ì£¼ì‹­ì‹œì˜¤.
            </p>

            <div class="question" data-question="C1">
                <div class="question-text">C1. ë‚˜ëŠ” ë‚´ ì§ë¬´ì„±ê³¼ë¥¼ ê³ ë ¤í•  ë•Œ ê³µì •í•œ ë³´ìƒì„ ë°›ê³  ìˆë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'C1', 1)">
                        <input type="radio" name="C1" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C1', 2)">
                        <input type="radio" name="C1" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C1', 3)">
                        <input type="radio" name="C1" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C1', 4)">
                        <input type="radio" name="C1" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C1', 5)">
                        <input type="radio" name="C1" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="C2">
                <div class="question-text">C2. ë‚˜ëŠ” ë‹´ë‹¹ì§ë¬´ì˜ ë‚œì´ë„ë¥¼ ê°ì•ˆí•  ë•Œ ê³µì •í•œ ë³´ìƒì„ ë°›ê³  ìˆë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'C2', 1)">
                        <input type="radio" name="C2" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C2', 2)">
                        <input type="radio" name="C2" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C2', 3)">
                        <input type="radio" name="C2" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C2', 4)">
                        <input type="radio" name="C2" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C2', 5)">
                        <input type="radio" name="C2" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="C3">
                <div class="question-text">C3. ë‚˜ëŠ” ë‹´ë‹¹ì§ë¬´ì˜ ì±…ì„ì„± ì •ë„ë¥¼ ê³ ë ¤í•  ë•Œ ê³µì •í•œ ë³´ìƒì„ ë°›ê³  ìˆë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'C3', 1)">
                        <input type="radio" name="C3" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C3', 2)">
                        <input type="radio" name="C3" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C3', 3)">
                        <input type="radio" name="C3" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C3', 4)">
                        <input type="radio" name="C3" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'C3', 5)">
                        <input type="radio" name="C3" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <p class="error-message" id="survey-c-error">ëª¨ë“  ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</p>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="validateSurveyC()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 7: ì„¤ë¬¸ D -->
        <div class="page" id="page-survey-d">
            <h1>ì¼ë°˜ ì„¤ë¬¸ (4/4)</h1>
            <div class="progress-text">ì „ì²´ ì§„í–‰ë¥ : 40%</div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 40%"></div>
            </div>
            <p style="color: #666; margin-bottom: 20px; font-weight: bold;">
                â…£. ë‹¤ìŒì€ í˜„ì¬ ê·¼ë¬´í•˜ëŠ” ê¸°ê´€ì˜ <strong>ì¸ì‚¬ì œë„</strong>ì— ê´€í•œ ê·€í•˜ì˜ ì˜ê²¬ì„ íŒŒì•…í•˜ê¸° ìœ„í•œ ë¬¸í•­ì…ë‹ˆë‹¤. ë³¸ì¸ì˜ ìƒê°ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì— í‘œì‹œí•´ì£¼ì‹­ì‹œì˜¤.
            </p>

            <div class="question" data-question="D1">
                <div class="question-text">D1. ìš°ë¦¬ê¸°ê´€ì€ ì§ì›ë“¤ì˜ ì§€ì†ì ì¸ ì—­ëŸ‰ ê°•í™” ë° ìê¸°ê³„ë°œì„ ìœ„í•œ ì²´ê³„ì ì¸ êµìœ¡ì§€ì› ì‹œìŠ¤í…œì´ ê°–ì¶”ì–´ì ¸ ìˆë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'D1', 1)">
                        <input type="radio" name="D1" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D1', 2)">
                        <input type="radio" name="D1" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D1', 3)">
                        <input type="radio" name="D1" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D1', 4)">
                        <input type="radio" name="D1" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D1', 5)">
                        <input type="radio" name="D1" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="D2">
                <div class="question-text">D2. ìš°ë¦¬ê¸°ê´€ì˜ ìŠ¹ì§„ ë° ì „í™˜Â·ë°°ì¹˜ì œë„ëŠ” ì²´ê³„ì ìœ¼ë¡œ ìš´ì˜ë˜ê³  ìˆë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'D2', 1)">
                        <input type="radio" name="D2" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D2', 2)">
                        <input type="radio" name="D2" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D2', 3)">
                        <input type="radio" name="D2" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D2', 4)">
                        <input type="radio" name="D2" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D2', 5)">
                        <input type="radio" name="D2" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <div class="question" data-question="D3">
                <div class="question-text">D3. ìš°ë¦¬ê¸°ê´€ì€ ìŠ¹ì§„ìì—ê²Œ ì ì ˆí•œ ì§€ì›(êµìœ¡, ì¸ë ¥, ë³´ìƒ ë“±)ì„ ì œê³µí•˜ê³  ìˆë‹¤.</div>
                <div class="likert-scale">
                    <label class="likert-option" onclick="selectLikert(this, 'D3', 1)">
                        <input type="radio" name="D3" value="1">
                        â‘  ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D3', 2)">
                        <input type="radio" name="D3" value="2">
                        â‘¡ ê·¸ë ‡ì§€ ì•Šë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D3', 3)">
                        <input type="radio" name="D3" value="3">
                        â‘¢ ë³´í†µì´ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D3', 4)">
                        <input type="radio" name="D3" value="4">
                        â‘£ ê·¸ë ‡ë‹¤
                    </label>
                    <label class="likert-option" onclick="selectLikert(this, 'D3', 5)">
                        <input type="radio" name="D3" value="5">
                        â‘¤ ë§¤ìš° ê·¸ë ‡ë‹¤
                    </label>
                </div>
            </div>

            <p class="error-message" id="survey-d-error">ëª¨ë“  ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</p>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="validateSurveyD()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 8: ë¹„ë„¤íŠ¸ ì•ˆë‚´ -->
        <div class="page" id="page-vignette-intro">
            <h1>ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ì„¤ë¬¸ ì•ˆë‚´</h1>
            <div class="intro-text">
                <p><strong>ì´ì œ ê°€ìƒì˜ ìŠ¹ì§„ ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ ì„¤ë¬¸ì„ ì‹œì‘í•©ë‹ˆë‹¤.</strong></p>
                <p style="margin-top: 15px;">
                    ë‹¤ìŒ í™”ë©´ë¶€í„°ëŠ” <strong>ì´ 10ê°œì˜ ê°€ìƒ ì‹œë‚˜ë¦¬ì˜¤</strong>ê°€ ì œì‹œë©ë‹ˆë‹¤.
                </p>
                <p style="margin-top: 15px;">
                    ê° ì‹œë‚˜ë¦¬ì˜¤ëŠ” 4ì§ê¸‰ì—ì„œ 3ì§ê¸‰(ì´ˆê¸‰ê°„ë¶€)ë¡œ ìŠ¹ì§„í•  ë•Œì˜ ë‹¤ì–‘í•œ ì¡°ê±´ë“¤ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.
                </p>
                <p style="margin-top: 15px;">
                    ê° ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì½ê³ , <strong>í•´ë‹¹ ì¡°ê±´ì—ì„œ ìŠ¹ì§„í•  ì˜í–¥ì´ ì–´ëŠ ì •ë„ì¸ì§€</strong>ë¥¼ 
                    <strong>0%ë¶€í„° 100%</strong> ì‚¬ì´ì˜ ìŠ¬ë¼ì´ë”ë¡œ í‘œì‹œí•´ì£¼ì„¸ìš”.
                </p>
                <p style="margin-top: 15px; color: #666;">
                    â€¢ 0% = ì „í˜€ ìŠ¹ì§„í•˜ê³  ì‹¶ì§€ ì•ŠìŒ<br>
                    â€¢ 50% = ë³´í†µ<br>
                    â€¢ 100% = ë§¤ìš° ìŠ¹ì§„í•˜ê³  ì‹¶ìŒ
                </p>
            </div>
            <div class="alert alert-info">
                <strong>ğŸ’¡ ì°¸ê³ :</strong> ê° ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë…ë¦½ì ì…ë‹ˆë‹¤. ì´ì „ ì‘ë‹µì— êµ¬ì• ë°›ì§€ ë§ê³  ê° ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ì†”ì§í•˜ê²Œ ë‹µë³€í•´ì£¼ì„¸ìš”.
            </div>
            <div class="btn-group-center">
                <button class="btn btn-primary" onclick="nextPage()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- í˜ì´ì§€ 10: í˜„í–‰ ì œë„ í‰ê°€ -->
        <div class="page" id="page-current-system">
            <h1>í˜„í–‰ ì œë„ í‰ê°€</h1>
            <p style="color: #666; margin-bottom: 10px"> ë¨¼ì €, ê·€í•˜ ê¸°ê´€ì˜ <strong>í˜„í–‰ ìŠ¹ì§„ ì œë„</strong>ì— ëŒ€í•´ í‰ê°€í•´ì£¼ì„¸ìš”.</p>

            <div id="current-system-table-container"></div>

            <div class="slider-container" style="margin-top: 30px;">
                <label style="font-size: 18px; font-weight: bold; margin-bottom: 20px; display: block; text-align: center;">
                    í˜„í–‰ ì œë„ì—ì„œ 3ì§ê¸‰ìœ¼ë¡œ ìŠ¹ì§„í•  ì˜í–¥ì´ ì–´ëŠ ì •ë„ì´ì‹­ë‹ˆê¹Œ?
                </label>
                <div class="slider-label">
                    <span>0% (ì „í˜€ ì˜í–¥ ì—†ìŒ)</span>
                    <span>100% (ë§¤ìš° ìŠ¹ì§„í•˜ê³  ì‹¶ìŒ)</span>
                </div>
                <input type="range" id="current-system-slider" min="0" max="100" value="50" step="5"
                       oninput="updateCurrentSystemSliderValue()">
                <div class="slider-value" id="current-system-slider-value">50%</div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevPage()">ì´ì „</button>
                <button class="btn btn-primary" onclick="saveCurrentSystemAndStart()">ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘</button>
            </div>
        </div>

        <!-- ë¹„ë„¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ í˜ì´ì§€ë“¤ (ë™ì  ìƒì„±) -->
        <div id="vignette-pages"></div>

        <!-- í˜ì´ì§€ ë§ˆì§€ë§‰: ì™„ë£Œ -->
        <div class="page" id="page-complete">
            <h1>ì„¤ë¬¸ ì™„ë£Œ</h1>
            <div class="completion-icon">âœ“</div>
            <div class="intro-text">
                <p style="text-align: center; font-size: 18px;">
                    <strong>ì„¤ë¬¸ì— ì°¸ì—¬í•´ì£¼ì…”ì„œ ì§„ì‹¬ìœ¼ë¡œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤!</strong>
                </p>
                <p style="margin-top: 20px; text-align: center;">
                    ê·€í•˜ì˜ ì†Œì¤‘í•œ ì‘ë‹µì€ ì—°êµ¬ì— í° ë„ì›€ì´ ë  ê²ƒì…ë‹ˆë‹¤.
                </p>
            </div>
            <div class="btn-group-center">
                <button class="btn btn-success" onclick="submitToGoogleSheets()">ì‘ë‹µ ì œì¶œí•˜ê¸°</button>
            </div>
            <div class="intro-text" style="margin-top: 20px; font-size: 14px;">
                <p style="text-align: center; color: #666;">
                    â€» ì œì¶œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‘ë‹µì´ ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.<br>
                    ë°±ì—…ìš© íŒŒì¼ë„ í•¨ê»˜ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤.
                </p>
            </div>
            <div class="intro-text" style="margin-top: 30px; font-size: 14px;">
                <p style="text-align: center; color: #666;">
                    ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì—°êµ¬ì§„ì—ê²Œ ì—°ë½ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br>
                    (email: eyang@kipf.re.kr)
                </p>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentPage = 0;
        let surveyData = {
            consent: null,
            demographics: {},
            surveyA: {},
            surveyB: {},
            surveyC: {},
            surveyD: {},
            currentSystemIntention: null,
            vignettes: []
        };
        let vignetteScenarios = [];
        let vignetteConditions = {};

        // ë¹„ë„¤íŠ¸ ì¡°ê±´ ì •ì˜
        function getVignetteConditions(organization) {
            const vignetteConditions = {
                'í•œêµ­ë‚¨ë¶€ë°œì „': {
                    baseSalary: ['3%', '5%', '7%'],
                    jobPay: ['10%', '20%', '30%'],
                    performancePay: ['150~250%', '133.5~267%', '100~300%'],
                    rotation: ['í˜„í–‰ ìœ ì§€', 'ì„ í˜¸ê¶Œì—­ ê·¼ë¬´ì œí•œì´ 13ë…„ìœ¼ë¡œ ì™„í™”'],
                    authority: ['í˜„í–‰ ìœ ì§€', 'í™•ëŒ€']
                },
                'í•œêµ­ì „ë ¥ê³µì‚¬': {
                    baseSalary: ['3%', '5%', '7%'],
                    jobPay: ['10%', '20%', '30%'],
                    performancePay: ['150~250%', '133~267%', '100~300%'],
                    rotation: ['í˜„í–‰ ìœ ì§€', 'ì„ í˜¸ê¶Œì—­ ê·¼ë¬´ì œí•œì´ 15ë…„ìœ¼ë¡œ ì™„í™”'],
                    authority: ['í˜„í–‰ ìœ ì§€', 'í™•ëŒ€']
                },
                'í•œêµ­ìˆ˜ë ¥ì›ìë ¥': {
                    baseSalary: ['3%', '5%', '7%'],
                    jobPay: ['10%', '20%', '30%'],
                    performancePay: ['150~250%', '133~266%', '100~300%'],
                    rotation: ['í˜„í–‰ ìœ ì§€', 'ì„ í˜¸ê¶Œì—­ ê·¼ë¬´ì œí•œì´ 10~12ë…„ìœ¼ë¡œ ì™„í™”'],
                    authority: ['í˜„í–‰ ìœ ì§€', 'í™•ëŒ€']
                }
            };
            return vignetteConditions[organization] || vignetteConditions['í•œêµ­ë‚¨ë¶€ë°œì „'];
        };

        // ê¸°ê´€ë³„ í˜„í–‰ ì œë„ ì •ë³´ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
        function getOrganizationTable(organization) {
           const tables = {
                'í•œêµ­ë‚¨ë¶€ë°œì „': '<table style="width: 100%; border-collapse: collapse; margin: 10px 0;">' +
                    '<thead><tr style="background: #6c757d; color: white;">' +
                    '<th style="padding: 6px; border: 1px solid #ddd; text-align: center; width: 20%;">í•­ëª©</th>' +
                    '<th style="padding: 6px; border: 1px solid #ddd; text-align: center;">í˜„í–‰ì œë„</th>' +
                    '</tr></thead><tbody>' +
                    '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ê¸°ë³¸ê¸‰ ì¡°ì •</td>' +
                    '<td style="padding: 6px; border: 1px solid #ddd; font-size: 14px;">' +
                    '<table style="width: 100%; border-collapse: collapse;">' +
                    '<tr style="background: #f8f9fa;"><td style="padding: 3px; border: 1px solid #ddd; text-align: center; font-weight: bold; width: 15%;">êµ¬ë¶„</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; text-align: center; font-weight: bold; width: 15%;">í˜¸ë´‰</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ê¸°ì¤€ê¸‰ ì „í™˜ ì‚°ì‹</td></tr>' +
                    '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">4(ê°€)ì§ê¸‰â†’<br>3ì§ê¸‰</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; text-align: center;">ì „ì²´</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;"> ((ë³¸ì¸ê¸°ë³¸ê¸‰ + (4(ê°€)4ë“±ê¸‰ ì§ëŠ¥ê¸‰+20ë§Œì›)) Ã— 12) Ã— 0.93 â€“(12,000ì²œì›)</td></tr>' +
                    '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;" rowspan="4">4(ë‚˜)ì§ê¸‰â†’<br>3ì§ê¸‰</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; text-align: center;">26í˜¸ë´‰ ì´ìƒ</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;"> ((ë³¸ì¸ê¸°ë³¸ê¸‰ + (4(ë‚˜)6ë“±ê¸‰ ì§ëŠ¥ê¸‰+20ë§Œì›)) Ã— 12)Ã— 0.98 â€“(12,000ì²œì›)</td></tr>' +
                    '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">21~25í˜¸ë´‰</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;"> ((ë³¸ì¸ê¸°ë³¸ê¸‰ + (4(ë‚˜)6ë“±ê¸‰ ì§ëŠ¥ê¸‰+20ë§Œì›)) Ã— 12)Ã— 0.99 â€“(12,000ì²œì›)</td></tr>' +
                    '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">15~20í˜¸ë´‰</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;"> ((ë³¸ì¸ê¸°ë³¸ê¸‰ + (4(ë‚˜)6ë“±ê¸‰ ì§ëŠ¥ê¸‰+20ë§Œì›)) Ã— 12) Ã— 1.01 â€“(12,000ì²œì›)</td></tr>' +
                    '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">15í˜¸ë´‰ ì´í•˜</td>' +
                    '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;"> ((ë³¸ì¸ê¸°ë³¸ê¸‰ + (4(ë‚˜)6ë“±ê¸‰ ì§ëŠ¥ê¸‰+20ë§Œì›)) Ã— 12) Ã— 1.02 â€“(12,000ì²œì›)</td></tr>' +
                    '</table>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ì§ë¬´ê¸‰ ì°¨ë“±</td>' +
                    '<td style="padding: 6px; border: 1px solid #ddd;">' +
                    '- 4ì§ê¸‰ ëŒ€ë¹„ 3ì§ê¸‰ì˜ í‰ê·  ì§ë¬´ê¸‰ ìˆ˜ì¤€: <strong>217.31%</strong>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ì„±ê³¼ê¸‰ ë³€ë™</td>' +
                    '<td style="padding: 6px; border: 1px solid #ddd;">' +
                    '- 4ì§ê¸‰ì˜ ì„±ê³¼ê¸‰ ë²”ìœ„ : <strong>200% (ê³ ì •)</strong><br>' +
                    '- 3ì§ê¸‰ì˜ ì„±ê³¼ê¸‰ ë²”ìœ„ : <strong>133.5 ~ 267%</strong>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ìˆœí™˜ë³´ì§ ì œë„</td>' +
                    '<td style="padding: 6px; border: 1px solid #ddd;">' +
                    '- ì„ í˜¸ ê¶Œì—­ë³„: ì‹ ì¸ì²œ, ë¶€ì‚°, ì‹ ì„¸ì¢…<br>' +
                    '- ì„ í˜¸ ê¶Œì—­ ê·¼ë¬´ ì œí•œê¸°ê°„: ì´ˆê¸‰ê°„ë¶€ <strong>8ë…„</strong>, ì¼ë°˜ì§ì› <strong>13ë…„</strong> ' +
                    '</td></tr>' +
                    '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">í‰ê°€ê¶Œí•œ ë²”ìœ„</td>' +
                    '<td style="padding: 6px; border: 1px solid #ddd;">' +
                    '- í‰ê°€ê¶Œí•œ: O<br>' +
                    '- í‰ê°€ê²°ê³¼ ì˜í–¥: ìŠ¹ì§„ - ìµœê·¼ 2ë…„ê°„ ê·¼ë¬´ì„±ì  ë°˜ì˜<br>'+
                    '<span style="margin-left: 122px;">ê¸‰ì—¬ - ê°„ì ‘ì  ì˜í–¥ (ì§ëŠ¥ë“±ê¸‰ ìŠ¹ê¸‰ìœ¼ë¡œ ì¸í•œ ì§ëŠ¥ê¸‰ ìƒìŠ¹)</span>' +
                    '</td></tr>' +
                    '</tbody></table>',
                
                'í•œêµ­ì „ë ¥ê³µì‚¬': '<table style="width: 100%; border-collapse: collapse; margin: 10px 0;">' +
                    '<thead><tr style="background: #6c757d; color: white;">' +
                    '<th style="padding: 12px; border: 1px solid #ddd; text-align: center; width: 20%;">í•­ëª©</th>' +
                    '<th style="padding: 12px; border: 1px solid #ddd; text-align: center;">í˜„í–‰ì œë„</th>' +
                    '</tr></thead><tbody>' +
                    '<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ê¸°ë³¸ê¸‰ ì¡°ì •</td>' +
                    '<td style="padding: 10px; border: 1px solid #ddd;">' +
                    '- 4(ê°€)ì§ê¸‰ â†’ 3ì§ê¸‰: ìŠ¹ì§„ ì „ ê¸°ì¤€ê¸‰ì•¡ ê¸°ì¤€ 4.9% ìƒí–¥ì¡°ì •<br>' +
                    '- 4(ë‚˜)ì§ê¸‰ â†’ 3ì§ê¸‰: ìŠ¹ì§„ ì „ ê¸°ë³¸ê¸‰ì•¡ ê¸°ì¤€ 9.9% ìƒí–¥ì¡°ì •<br>' +
                    '<span style="margin-left: 160px; font-size: 13px; color: #666;">(â€» ì¡°ì •ì•¡ì´ 3ì§ê¸‰ í•˜í•œì•¡ ì´í•˜ì¼ ê²½ìš° í•˜í•œì•¡ ì ìš©)</span>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ì§ë¬´ê¸‰ ì°¨ë“±</td>' +
                    '<td style="padding: 10px; border: 1px solid #ddd;">' +
                    '- 4ì§ê¸‰ ëŒ€ë¹„ 3ì§ê¸‰ì˜ í‰ê·  ì§ë¬´ê¸‰ ìˆ˜ì¤€: <strong>117.10%</strong>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ì„±ê³¼ê¸‰ ë³€ë™</td>' +
                    '<td style="padding: 10px; border: 1px solid #ddd;">' +
                    '- 4ì§ê¸‰ì˜ ì„±ê³¼ê¸‰ ë²”ìœ„: <strong>180~220%</strong><br>' +
                    '- 3ì§ê¸‰ì˜ ì„±ê³¼ê¸‰ ë²”ìœ„: <strong>133~267%</strong>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ìˆœí™˜ë³´ì§ ì œë„</td>' +
                    '<td style="padding: 10px; border: 1px solid #ddd;">' +
                    '- ì„ í˜¸ ê¶Œì—­ì£¼: ìˆ˜ë„ê¶Œì‚¬ì—…ì†Œ(ì„œìš¸ãƒ»ë‚¨ì„œìš¸ãƒ»ê²½ê¸°ãƒ»ê²½ê¸° ë¶ë¶€ãƒ»ì¸ì²œ)<br>' +
                    '- ì„ í˜¸ ê¶Œì—­ ê·¼ë¬´ ì œí•œê¸°ê°„: ì´ˆê¸‰ê°„ë¶€ <strong>6ë…„</strong>, ì¼ë°˜ì§ì› <strong>ì œí•œì—†ìŒ</strong>' +
                    '</td></tr>' +
                    '<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">í‰ê°€ê¶Œí•œ ë²”ìœ„</td>' +
                    '<td style="padding: 10px; border: 1px solid #ddd;">' +
                    '- í‰ê°€ê¶Œí•œ: O<br>' +
                    '- í‰ê°€ê²°ê³¼ ì˜í–¥: ìŠ¹ì§„ - ìµœê·¼ 3ë…„ê°„ ê·¼ë¬´ì„±ì  ë°˜ì˜<br>' +
                    '<span style="margin-left: 122px;">ê¸‰ì—¬ - ì˜í–¥ì—†ìŒ</span>' +
                    '</td></tr>' +
                    '</tbody></table>',
                
                 'í•œêµ­ìˆ˜ë ¥ì›ìë ¥': '<table style="width: 100%; border-collapse: collapse; margin: 10px 0;">' +
                '<thead><tr style="background: #6c757d; color: white;">' +
                '<th style="padding: 6px; border: 1px solid #ddd; text-align: center; width: 20%;">í•­ëª©</th>' +
                '<th style="padding: 6px; border: 1px solid #ddd; text-align: center;">í˜„í–‰ì œë„</th>' +
                '</tr></thead><tbody>' +
                '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ê¸°ë³¸ê¸‰ ì¡°ì •</td>' +
                '<td style="padding: 6px; border: 1px solid #ddd; font-size: 14px;">' +
                '<table style="width: 100%; border-collapse: collapse;">' +
                '<tr style="background: #f8f9fa;"><td style="padding: 3px; border: 1px solid #ddd; text-align: center; font-weight: bold; width: 20%;">êµ¬ë¶„</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; text-align: center; font-weight: bold; width: 15%;">ì§ëŠ¥ë“±ê¸‰</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ê¸°ì¤€ê¸‰ ì „í™˜ ì‚°ì‹</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;" rowspan="5">4(ê°‘)â†’<br>3ì§ê¸‰</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; text-align: center;">5, 6</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.22)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">4</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.25)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">3</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.28)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">2</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.32)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">1</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.36)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;" rowspan="4">4(ì„)â†’<br>3ì§ê¸‰</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; text-align: center;">6</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.40)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">5</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.42)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">4</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.47)Ã— 12) -22,800ì²œì›</td></tr>' +
                '<tr><td style="padding: 3px; border: 1px solid #ddd; text-align: center;">3</td>' +
                '<td style="padding: 3px; border: 1px solid #ddd; font-size: 13px;">((ë³¸ì¸ê¸°ì¤€ê¸‰ * 1.51)Ã— 12) -22,800ì²œì›</td></tr>' +
                '</table>' +
                '</td></tr>' +
                '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ì§ë¬´ê¸‰ ì°¨ë“±</td>' +
                '<td style="padding: 6px; border: 1px solid #ddd;">' +
                '- 4ì§ê¸‰ ëŒ€ë¹„ 3ì§ê¸‰ì˜ í‰ê·  ì§ë¬´ê¸‰ ìˆ˜ì¤€: <strong>184.27%</strong>' +
                '</td></tr>' +
                '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ì„±ê³¼ê¸‰ ë³€ë™</td>' +
                '<td style="padding: 6px; border: 1px solid #ddd;">' +
                '- 4ì§ê¸‰ì˜ ì„±ê³¼ê¸‰ ë²”ìœ„ : <strong>200% (ê³ ì •)</strong><br>' +
                '- 3ì§ê¸‰ì˜ ì„±ê³¼ê¸‰ ë²”ìœ„ : <strong>133.3 ~ 266%</strong>' +
                '</td></tr>' +
                '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">ìˆœí™˜ë³´ì§ ì œë„</td>' +
                '<td style="padding: 6px; border: 1px solid #ddd;">' +
                '- ì„ í˜¸ ê¶Œì—­ì£¼: ê³ ë¦¬/ìƒˆìš¸ë³¸ë¶€, ì¸ì¬ê°œë°œì›<br>' +
                '- ì„ í˜¸ ê¶Œì—­ ê·¼ë¬´ ì œí•œê¸°ê°„: ì´ˆê¸‰ê°„ë¶€ <strong>7ë…„</strong>, ì¼ë°˜ì§ì› <strong>8~12ë…„</strong>' +
                '</td></tr>' +
                '<tr><td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">í‰ê°€ê¶Œí•œ ë²”ìœ„</td>' +
                '<td style="padding: 6px; border: 1px solid #ddd;">' +
                '- í‰ê°€ê¶Œí•œ: O<br>' +
                '- í‰ê°€ê²°ê³¼ ì˜í–¥: ìŠ¹ì§„ - ìµœê·¼ 2ë…„ê°„ ê·¼ë¬´ì„±ì  ë°˜ì˜<br>'+
                    '<span style="margin-left: 122px;">ê¸‰ì—¬ - ê°„ì ‘ì  ì˜í–¥ (ì§ëŠ¥ë“±ê¸‰ ìŠ¹ê¸‰ìœ¼ë¡œ ì¸í•œ ì§ëŠ¥ê¸‰ ìƒìŠ¹)</span>' +
                '</td></tr>' +
                '</tbody></table>'
        };
            return tables[organization] || '';
        }

        // í˜ì´ì§€ ì´ë™
        function nextPage() {
            const pages = document.querySelectorAll('.page');
            pages[currentPage].classList.remove('active');
            currentPage++;
            pages[currentPage].classList.add('active');
            window.scrollTo(0, 0);
            
            // í˜„í–‰ ì œë„ í‰ê°€ í˜ì´ì§€ì— ë„ë‹¬í–ˆì„ ë•Œ í…Œì´ë¸” í‘œì‹œ
            if (pages[currentPage].id === 'page-current-system') {
                displayCurrentSystemTable();
            }
        }

        function prevPage() {
            const pages = document.querySelectorAll('.page');
            pages[currentPage].classList.remove('active');
            currentPage--;
            pages[currentPage].classList.add('active');
            window.scrollTo(0, 0);
        }

        // ë™ì˜ ì„ íƒ
        function selectConsent(agree) {
            surveyData.consent = agree;
            document.querySelectorAll('input[name="consent"]').forEach(radio => {
                radio.checked = false;
            });
            event.target.closest('.radio-option').querySelector('input').checked = true;
            
            document.querySelectorAll('.radio-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.closest('.radio-option').classList.add('selected');
        }

        function checkConsent() {
            if (surveyData.consent === null) {
                document.getElementById('consent-error').style.display = 'block';
                return;
            }
            if (surveyData.consent === false) {
                alert('ì„¤ë¬¸ ì°¸ì—¬ì— ë™ì˜í•˜ì§€ ì•Šìœ¼ì…¨ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.');
                return;
            }
            document.getElementById('consent-error').style.display = 'none';
            nextPage();
        }

        // ì§ì¢… ê¸°íƒ€ ì…ë ¥
        function toggleJobTypeOther() {
            const select = document.getElementById('job-type');
            const otherInput = document.getElementById('job-type-other');
            if (select.value === 'ê¸°íƒ€') {
                otherInput.style.display = 'block';
            } else {
                otherInput.style.display = 'none';
            }
        }

        // ê¸°ë³¸ì •ë³´ ìœ íš¨ì„± ê²€ì‚¬
        function validateDemographics() {
            const organization = document.getElementById('organization').value;
            const grade = document.getElementById('grade').value;
            const jobType = document.getElementById('job-type').value;
            const jobTypeOther = document.getElementById('job-type-other').value;
            const years = document.getElementById('years').value;
            const months = document.getElementById('months').value;
            const birthYear = document.getElementById('birth-year').value;
            const gender = document.getElementById('gender').value;
            const education = document.getElementById('education').value;
            const maritalStatus = document.getElementById('marital-status').value;
            const children = document.getElementById('children').value;

            if (!organization || !grade || !jobType || !years || !months || 
                !birthYear || !gender || !education || !maritalStatus || !children) {
                document.getElementById('demographics-error').style.display = 'block';
                return;
            }

            if (jobType === 'ê¸°íƒ€' && !jobTypeOther) {
                document.getElementById('demographics-error').textContent = 'ì§ì¢…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                document.getElementById('demographics-error').style.display = 'block';
                return;
            }

            surveyData.demographics = {
                organization,
                grade,
                jobType: jobType === 'ê¸°íƒ€' ? jobTypeOther : jobType,
                tenure: `${years}ë…„ ${months}ê°œì›”`,
                birthYear,
                gender,
                education,
                maritalStatus,
                children
            };

            document.getElementById('demographics-error').style.display = 'none';
            nextPage();
        }

        // Likert ì„ íƒ
        function selectLikert(element, questionId, value) {
            const question = element.closest('.question');
            question.querySelectorAll('.likert-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            element.querySelector('input').checked = true;
        }

        // ì„¤ë¬¸ A ìœ íš¨ì„± ê²€ì‚¬
        function validateSurveyA() {
            const questions = ['A1', 'A2', 'A3', 'A4'];
            for (let q of questions) {
                const selected = document.querySelector(`input[name="${q}"]:checked`);
                if (!selected) {
                    document.getElementById('survey-a-error').style.display = 'block';
                    return;
                }
                surveyData.surveyA[q] = selected.value;
            }
            document.getElementById('survey-a-error').style.display = 'none';
            nextPage();
        }

        // ì„¤ë¬¸ B ìœ íš¨ì„± ê²€ì‚¬
        function validateSurveyB() {
            const questions = ['B1', 'B2', 'B3'];
            for (let q of questions) {
                const selected = document.querySelector(`input[name="${q}"]:checked`);
                if (!selected) {
                    document.getElementById('survey-b-error').style.display = 'block';
                    return;
                }
                surveyData.surveyB[q] = selected.value;
            }
            document.getElementById('survey-b-error').style.display = 'none';
            nextPage();
        }

        // ì„¤ë¬¸ C ìœ íš¨ì„± ê²€ì‚¬
        function validateSurveyC() {
            const questions = ['C1', 'C2', 'C3'];
            for (let q of questions) {
                const selected = document.querySelector(`input[name="${q}"]:checked`);
                if (!selected) {
                    document.getElementById('survey-c-error').style.display = 'block';
                    return;
                }
                surveyData.surveyC[q] = selected.value;
            }
            document.getElementById('survey-c-error').style.display = 'none';
            nextPage();
        }

        // ì„¤ë¬¸ D ìœ íš¨ì„± ê²€ì‚¬
        function validateSurveyD() {
            const questions = ['D1', 'D2', 'D3'];
            for (let q of questions) {
                const selected = document.querySelector(`input[name="${q}"]:checked`);
                if (!selected) {
                    document.getElementById('survey-d-error').style.display = 'block';
                    return;
                }
                surveyData.surveyD[q] = selected.value;
            }
            document.getElementById('survey-d-error').style.display = 'none';
            nextPage();
        }

        // ë¹„ë„¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ìƒì„±
        function generateVignettes() {
            vignetteScenarios = [];
            for (let i = 0; i < 10; i++) {
                const scenario = {
                    id: i + 1,
                    baseSalary: vignetteConditions.baseSalary[Math.floor(Math.random() * 3)],
                    jobPay: vignetteConditions.jobPay[Math.floor(Math.random() * 3)],
                    performancePay: vignetteConditions.performancePay[Math.floor(Math.random() * 3)],
                    rotation: vignetteConditions.rotation[Math.floor(Math.random() * 2)],
                    authority: vignetteConditions.authority[Math.floor(Math.random() * 2)]
                };
                vignetteScenarios.push(scenario);
            }
        }

        // ë¹„ë„¤íŠ¸ í˜ì´ì§€ ìƒì„±
        function createVignettePages() {
            const container = document.getElementById('vignette-pages');
            const userOrganization = surveyData.demographics.organization;
            const orgTable = getOrganizationTable(userOrganization);
            
            // ê¸°ê´€ë³„ ì œëª© ì„¤ì •
            let tableTitle = 'ìŠ¹ì§„ ê´€ë ¨ í˜„í–‰ ì œë„';
            
            
            vignetteScenarios.forEach((scenario, index) => {
                const progress = 50 + (index + 1) * 5;   

                // í˜„í–‰ ì œë„ ì •ë³´ HTML (í…Œì´ë¸”ì´ ìˆì„ ê²½ìš°)
                const currentSystemHTML = orgTable ? `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 2px solid #6c757d;">
                        <h3 style="color: #6c757d; text-align: center; margin-bottom: 15px; font-size: 18px;">
                            ğŸ“Š ê·€í•˜ì˜ ê¸°ê´€(${userOrganization}) ${tableTitle}
                        </h3>
                        <div style="overflow-x: auto;">
                            ${orgTable}
                        </div>
                        <p style="text-align: center; margin-top: 15px; font-size: 14px; color: #666;">
                            â€» ìœ„ ê¸°ì¤€ ëŒ€ë¹„ ì•„ë˜ ì‹œë‚˜ë¦¬ì˜¤ì˜ ì¡°ê±´ì„ ë¹„êµí•˜ì—¬ ë‹µë³€í•´ì£¼ì„¸ìš”.
                        </p>
                    </div>
                ` : `
                    <div class="alert alert-info" style="margin-bottom: 25px;">
                        <strong>ğŸ“Š ì°¸ê³ :</strong> ê·€í•˜ì˜ ê¸°ê´€(${userOrganization})ì˜ í˜„í–‰ ì œë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì•„ë˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í‰ê°€í•´ì£¼ì„¸ìš”.
                    </div>
                `;
                
                const pageHTML = `
                    <div class="page" id="page-vignette-${index}">
                        <h1>ì‹œë‚˜ë¦¬ì˜¤ ${scenario.id} / 10</h1>
                        <div class="progress-text">ì „ì²´ ì§„í–‰ë¥ : ${progress}%</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>

                        ${currentSystemHTML}

                        <div class="scenario-box">
                            <div class="scenario-title">ğŸ¯ ë‹¤ìŒ ìŠ¹ì§„ ì¡°ê±´ì„ ê°€ì •í•´ì£¼ì„¸ìš”</div>
                            <div class="scenario-condition">
                                <strong>1. ê¸°ë³¸ê¸‰ ìƒìŠ¹:</strong> ìŠ¹ì§„ ì‹œ ê¸°ë³¸ê¸‰ì´ í˜„í–‰ ëŒ€ë¹„ <strong style="color: black;">${scenario.baseSalary} ì¦ê°€</strong>í•©ë‹ˆë‹¤.
                            </div>
                            <div class="scenario-condition">
                                <strong>2. ì§ë¬´ê¸‰ ì°¨ë“±:</strong> ìŠ¹ì§„ ì‹œ ì¼ë°˜ì§ì› ëŒ€ë¹„ <strong style="color: black;">í˜„í–‰ ì¦ê°€ë¶„+${scenario.jobPay} ë†’ì€ ì§ë¬´ì— ë°°ì¹˜</strong>ë©ë‹ˆë‹¤.
                            </div>
                            <div class="scenario-condition">
                                <strong>3. ì„±ê³¼ê¸‰ íš¨ê³¼:</strong> ê°œì¸ ì„±ê³¼ì— ë”°ë¼ ê¸°ë³¸ì›”ì•¡ì˜ <strong style="color: black;">${scenario.performancePay} ë²”ìœ„</strong>ë¡œ ë³´ìƒë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                            </div>
                            <div class="scenario-condition">
                                <strong>4. ìˆœí™˜ë³´ì§ ì˜ë¬´:</strong> ìˆœí™˜ë³´ì§ ì˜ë¬´ê°€ <strong style="color: black;">${scenario.rotation}</strong>ë©ë‹ˆë‹¤.
                            </div>
                            <div class="scenario-condition">
                                <strong>5. ê´€ë¦¬ê¶Œí•œ:</strong> íŒ€ì›ì— ëŒ€í•œ ê´€ë¦¬ê¶Œí•œì´ <strong style="color: black;">${scenario.authority}</strong>ë©ë‹ˆë‹¤.
                            </div>

                             ${scenario.authority === 'í™•ëŒ€' ? `
                            <div style="background: #fff9e6; padding: 10px 20px; border-radius: 10px; margin: 10px 0; border-left: 4px solid #ffa726;">
                            <div style="font-weight: bold; color: #f57c00; margin-bottom: 8px; font-size: 16px;">
                                â„¹ï¸ ê´€ë¦¬ê¶Œí•œ í™•ëŒ€ ì„¸ë¶€ ì‚¬í•­:
                            </div>
                            <div style="font-size: 14px; line-height: 1.2; color: #333;">
                                <p style="margin: 6px 0;">
                                    <strong>â€¢ ì¸ì‚¬(ë°°ì¹˜, ìŠ¹ê¸‰ ë“±):</strong> ìµœê·¼ 2-3ë…„ê°„ ê·¼ë¬´ì„±ì  í‰ê°€ ê²°ê³¼ë¥¼ ë°˜ì˜í•˜ì—¬ ì§ë¬´, íŒ€, ì‚¬ì—…ì†Œ ë°°ì¹˜ì— ë°˜ì˜ *ì´ˆê¸‰ê°„ë¶€ì˜ ì˜ê²¬ ë°˜ì˜
                                </p>
                                <p style="margin: 6px 0;">
                                    <strong>â€¢ ê¸‰ì—¬:</strong> ìµœê·¼ 2ë…„ê°„ ê·¼ë¬´ì„±ì  í‰ê°€ ê²°ê³¼ê°€ ì¤‘ê°„ ë“±ê¸‰ ì´í•˜ì¸ ê²½ìš° ê¸°ë³¸ê¸‰ ì¸ìƒ ì œí•œ
                                </p>
                                <p style="margin: 6px 0;">
                                    <strong>â€¢ ìŠ¹ì§„:</strong> ìµœê·¼ 2ë…„ ë˜ëŠ” 3ë…„ê°„ ê·¼ë¬´ì„±ì  í‰ê°€ ê²°ê³¼ê°€ ì¤‘ê°„ ë“±ê¸‰ ì´í•˜ì¸ ê²½ìš°, ìŠ¹ì§„(5â†’4ê¸‰, 4â†’3ê¸‰) ì œí•œ
                                </p>
                            </div>
                        </div>
                        ` : ''}
                       </div>

                        <div class="slider-container">
                            <label style="font-size: 18px; font-weight: bold; margin-bottom: 20px; display: block;">
                                ìœ„ ì¡°ê±´ì—ì„œ 3ì§ê¸‰ìœ¼ë¡œ ìŠ¹ì§„í•  ì˜í–¥ì´ ì–´ëŠ ì •ë„ì´ì‹­ë‹ˆê¹Œ?
                            </label>
                            <div class="slider-label">
                                <span>0% (ì „í˜€ ì˜í–¥ ì—†ìŒ)</span>
                                <span>100% (ë§¤ìš° ìŠ¹ì§„í•˜ê³  ì‹¶ìŒ)</span>
                            </div>
                            <input type="range" id="vignette-slider-${index}" min="0" max="100" value="50" step="5"
                                   oninput="updateSliderValue(${index})">
                            <div class="slider-value" id="slider-value-${index}">50%</div>
                        </div>

                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="prevVignette(${index})">ì´ì „</button>
                            <button class="btn btn-primary" onclick="nextVignette(${index})">
                                ${index === 9 ? 'ì™„ë£Œ' : 'ë‹¤ìŒ'}
                            </button>
                        </div>
                    </div>
                `;
                container.innerHTML += pageHTML;
            });
        }

        // ìŠ¬ë¼ì´ë” ê°’ ì—…ë°ì´íŠ¸
        function updateSliderValue(index) {
            const slider = document.getElementById(`vignette-slider-${index}`);
            const valueDisplay = document.getElementById(`slider-value-${index}`);
            valueDisplay.textContent = slider.value + '%';
        }

        // ë¹„ë„¤íŠ¸ ë„¤ë¹„ê²Œì´ì…˜
        function prevVignette(index) {
            prevPage();
        }

        function nextVignette(index) {
            const slider = document.getElementById(`vignette-slider-${index}`);
            surveyData.vignettes.push({
                scenarioId: index + 1,
                conditions: vignetteScenarios[index],
                intention: parseInt(slider.value)
            });

            if (index === 9) {
                // ë§ˆì§€ë§‰ ì‹œë‚˜ë¦¬ì˜¤
                nextPage();
            } else {
                nextPage();
            }
        }

        // í˜„í–‰ ì œë„ í…Œì´ë¸” í‘œì‹œ
        function displayCurrentSystemTable() {
            const userOrganization = surveyData.demographics.organization;
            const orgTable = getOrganizationTable(userOrganization);
            const container = document.getElementById('current-system-table-container');
            
            if (orgTable) {
                container.innerHTML = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid #6c757d;">
                        <h3 style="color: #6c757d; text-align: center; margin-bottom: 15px; font-size: 18px;">
                            ğŸ“Š ê·€í•˜ì˜ ê¸°ê´€(${userOrganization}) ìŠ¹ì§„ ê´€ë ¨ í˜„í–‰ ì œë„
                        </h3>
                        <div style="overflow-x: auto;">
                            ${orgTable}
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="alert alert-info">
                        <strong>ğŸ“Š ì°¸ê³ :</strong> ê·€í•˜ì˜ ê¸°ê´€(${userOrganization})ì˜ í˜„í–‰ ì œë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•´ì£¼ì„¸ìš”.
                    </div>
                `;
            }
        }

        // í˜„í–‰ ì œë„ ìŠ¬ë¼ì´ë” ê°’ ì—…ë°ì´íŠ¸
        function updateCurrentSystemSliderValue() {
            const slider = document.getElementById('current-system-slider');
            const valueDisplay = document.getElementById('current-system-slider-value');
            valueDisplay.textContent = slider.value + '%';
        }

        // í˜„í–‰ ì œë„ í‰ê°€ ì €ì¥ ë° ë¹„ë„¤íŠ¸ ì‹œì‘
        function saveCurrentSystemAndStart() {
            const slider = document.getElementById('current-system-slider');
            surveyData.currentSystemIntention = parseInt(slider.value);
            startVignettes();
        }

        // ë¹„ë„¤íŠ¸ ì‹œì‘
        function startVignettes() {
            const userOrganization = surveyData.demographics.organization;
            vignetteConditions = getVignetteConditions(userOrganization); 
            generateVignettes();
            createVignettePages();
            nextPage();
        }

        // Google Sheetsë¡œ ë°ì´í„° ì „ì†¡
        async function submitToGoogleSheets() {
            // ì—¬ê¸°ì— Apps Script ì›¹ ì•± URLì„ ì…ë ¥í•˜ì„¸ìš”
            const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE';
            
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                alert('Google Sheets ì—°ë™ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\n\nê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ê±°ë‚˜ ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ JSON íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.');
                downloadData();
                return;
            }
            
            try {
                surveyData.timestamp = new Date().toISOString();
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(surveyData)
                });
                
                // no-cors ëª¨ë“œì—ì„œëŠ” ì‘ë‹µì„ ì½ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì„±ê³µìœ¼ë¡œ ê°„ì£¼
                alert('ì„¤ë¬¸ ì‘ë‹µì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\nê°ì‚¬í•©ë‹ˆë‹¤.');
                
                // ë°±ì—…ìš© ë‹¤ìš´ë¡œë“œë„ ì œê³µ
                downloadData();
                
            } catch (error) {
                console.error('Error:', error);
                alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ê´€ë¦¬ìì—ê²Œ ë³´ë‚´ì£¼ì„¸ìš”.(email: eyang@kipf.re.kr)');
                downloadData();
            }
        }
        
        // ë°ì´í„° ë‹¤ìš´ë¡œë“œ (ë°±ì—…ìš©)
        function downloadData() {
            surveyData.timestamp = new Date().toISOString();
            const dataStr = JSON.stringify(surveyData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `survey-response-${Date.now()}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>